var e,n,t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},t(e,n)};function r(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(n){o(n)}}function u(e){try{c(r.throw(e))}catch(n){o(n)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,u)}c((r=r.apply(e,n||[])).next())}))}function i(e,n){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(a=0)),a;)try{if(t=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=n.call(e,a)}catch(c){u=[6,c],r=0}finally{t=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}function o(e,n,t){if(t||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}!function(e){e[e.Success=0]="Success",e[e.Undefined=-1]="Undefined",e[e.NotFunction=-2]="NotFunction",e[e.UnexpectedBehaviour=-3]="UnexpectedBehaviour",e[e.Null=-4]="Null"}(e||(e={})),function(e){e.Awesomium="awesomium",e.Cef="cef",e.CefSharp="cefsharp",e.CoachJS="coachjs",e.Electron="electron",e.FMiner="fminer",e.Geb="geb",e.NightmareJS="nightmarejs",e.Phantomas="phantomas",e.PhantomJS="phantomjs",e.Rhino="rhino",e.Selenium="selenium",e.Sequentum="sequentum",e.SlimerJS="slimerjs",e.WebDriverIO="webdriverio",e.WebDriver="webdriver",e.HeadlessChrome="headless_chrome",e.Unknown="unknown"}(n||(n={}));var a,u,c=function(e){function n(t,r){var i=e.call(this,r)||this;return i.state=t,i.name="BotdError",Object.setPrototypeOf(i,n.prototype),i}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,e),n}(Error);function s(e,n){return-1!==e.indexOf(n)}function d(e,n){return-1!==e.indexOf(n)}function f(e,n){if("find"in e)return e.find(n);for(var t=0;t<e.length;t++)if(n(e[t],t,e))return e[t]}function l(e){return Object.getOwnPropertyNames(e)}function v(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var r=function(n){if("string"==typeof n){if(s(e,n))return{value:!0}}else if(null!=f(e,(function(e){return n.test(e)})))return{value:!0}},i=0,o=n;i<o.length;i++){var a=o[i],u=r(a);if("object"==typeof u)return u.value}return!1}function w(e){return e.reduce((function(e,n){return e+(n?1:0)}),0)}function p(){var e,n,t=window,r=navigator;return w(["webkitPersistentStorage"in r,"webkitTemporaryStorage"in r,0===r.vendor.indexOf("Google"),"webkitResolveLocalFileSystemURL"in t,"BatteryManager"in t,"webkitMediaStream"in t,"webkitSpeechGrammar"in t])>=5?a.Chromium:w(["ApplePayError"in t,"CSSPrimitiveValue"in t,"Counter"in t,0===r.vendor.indexOf("Apple"),"getStorageUpdates"in r,"WebKitMediaKeys"in t])>=4?a.Webkit:w(["buildID"in navigator,"MozAppearance"in(null!==(n=null===(e=document.documentElement)||void 0===e?void 0:e.style)&&void 0!==n?n:{}),"onmozfullscreenchange"in t,"mozInnerScreenX"in t,"CSSMozDocumentRule"in t,"CanvasCaptureMediaStream"in t])>=4?a.Gecko:a.Unknown}function m(){var e,n=null===(e=navigator.userAgent)||void 0===e?void 0:e.toLowerCase();return d(n,"wechat")?u.WeChat:d(n,"firefox")?u.Firefox:d(n,"opera")||d(n,"opr")?u.Opera:d(n,"chrome")?u.Chrome:d(n,"safari")?u.Safari:d(n,"trident")||d(n,"msie")?u.IE:u.Unknown}!function(e){e.Unknown="unknown",e.Chromium="chromium",e.Gecko="gecko",e.Webkit="webkit"}(a||(a={})),function(e){e.Unknown="unknown",e.Chrome="chrome",e.Firefox="firefox",e.Opera="opera",e.Safari="safari",e.IE="internet_explorer",e.WeChat="wechat"}(u||(u={}));var h={detectAppVersion:function(t){var r=t.appVersion;return r.state===e.Success&&(/headless/i.test(r.value)?n.HeadlessChrome:/electron/i.test(r.value)?n.Electron:/slimerjs/i.test(r.value)?n.SlimerJS:void 0)},detectDocumentAttributes:function(t){var r=t.documentElementKeys;return r.state===e.Success&&(v(r.value,"selenium","webdriver","driver")?n.Selenium:void 0)},detectErrorTrace:function(t){var r=t.errorTrace;return r.state===e.Success&&(/PhantomJS/i.test(r.value)?n.PhantomJS:void 0)},detectEvalLengthInconsistency:function(n){var t=n.evalLength;if(t.state===e.Success){var r=t.value,i=m(),o=p();return 37===r&&!s([a.Webkit,a.Gecko],o)||39===r&&!s([u.IE],i)||33===r&&!s([a.Chromium],o)}},detectFunctionBind:function(t){if(t.functionBind.state===e.NotFunction)return n.PhantomJS},detectLanguagesLengthInconsistency:function(t){var r=t.languages;if(r.state===e.Success&&0===r.value.length)return n.HeadlessChrome},detectNotificationPermissions:function(t){var r=t.notificationPermissions;return m()===u.Chrome&&(r.state===e.Success&&r.value?n.HeadlessChrome:void 0)},detectPluginsArray:function(t){var r=t.pluginsArray;if(r.state===e.Success&&!r.value)return n.HeadlessChrome},detectPluginsLengthInconsistency:function(t){var r=t.pluginsLength;if(r.state===e.Success){var i=p();if(!(i===a.Chromium&&function(){var e=p(),n=e===a.Chromium,t=e===a.Gecko;if(!n&&!t)return!1;var r=window;return w(["onorientationchange"in r,"orientation"in r,n&&!("SharedWorker"in r),t&&/android/i.test(navigator.appVersion)])>=2}()||i===a.Webkit&&!function(){if(p()!==a.Webkit)return!1;var e=window;return w(["safari"in e,!("DeviceMotionEvent"in e),!("ongestureend"in e),!("standalone"in navigator)])>=3}()))return 0===r.value?n.HeadlessChrome:void 0}},detectProcess:function(t){var r,i=t.process;return i.state===e.Success&&("renderer"===i.value.type||null!=(null===(r=i.value.versions)||void 0===r?void 0:r.electron)?n.Electron:void 0)},detectUserAgent:function(t){var r=t.userAgent;return r.state===e.Success&&(/PhantomJS/i.test(r.value)?n.PhantomJS:/Headless/i.test(r.value)?n.HeadlessChrome:/Electron/i.test(r.value)?n.Electron:/slimerjs/i.test(r.value)?n.SlimerJS:void 0)},detectWebDriver:function(t){var r=t.webDriver;if(r.state===e.Success&&r.value)return n.HeadlessChrome},detectWebGL:function(t){var r=t.webGL;if(r.state===e.Success){var i=r.value,o=i.vendor,a=i.renderer;if("Brian Paul"==o&&"Mesa OffScreen"==a)return n.HeadlessChrome}},detectWindowExternal:function(t){var r=t.windowExternal;return r.state===e.Success&&(/Sequentum/i.test(r.value)?n.Sequentum:void 0)},detectWindowSize:function(t){var r=t.windowSize;if(r.state!==e.Success)return!1;var i=r.value,o=i.outerWidth,a=i.outerHeight;return void 0!==document.hasFocus&&document.hasFocus()&&0===o&&0===a?n.HeadlessChrome:void 0},detectMimeTypesConsistent:function(t){var r=t.mimeTypesConsistent;if(r.state===e.Success&&!r.value)return n.Unknown},detectProductSub:function(t){var r=t.productSub;if(r.state!==e.Success)return!1;var i=m();return i!==u.Chrome&&i!==u.Safari&&i!==u.Opera&&i!==u.WeChat||"20030107"===r.value?void 0:n.Unknown},detectDistinctiveProperties:function(n){var t=n.distinctiveProps;if(t.state!==e.Success)return!1;var r,i=t.value;for(r in i)if(i[r])return r}};var g={userAgent:function(){return navigator.userAgent},appVersion:function(){var n=navigator.appVersion;if(null==n)throw new c(e.Undefined,"navigator.appVersion is undefined");return n},rtt:function(){if(void 0===navigator.connection)throw new c(e.Undefined,"navigator.connection is undefined");if(void 0===navigator.connection.rtt)throw new c(e.Undefined,"navigator.connection.rtt is undefined");return navigator.connection.rtt},windowSize:function(){return{outerWidth:window.outerWidth,outerHeight:window.outerHeight,innerWidth:window.innerWidth,innerHeight:window.innerHeight}},pluginsLength:function(){if(void 0===navigator.plugins)throw new c(e.Undefined,"navigator.plugins is undefined");if(void 0===navigator.plugins.length)throw new c(e.UnexpectedBehaviour,"navigator.plugins.length is undefined");return navigator.plugins.length},pluginsArray:function(){if(void 0===navigator.plugins)throw new c(e.Undefined,"navigator.plugins is undefined");if(void 0===window.PluginArray)throw new c(e.Undefined,"window.PluginArray is undefined");return navigator.plugins instanceof PluginArray},errorTrace:function(){try{null[0]()}catch(n){if(n instanceof Error&&null!=n.stack)return n.stack.toString()}throw new c(e.UnexpectedBehaviour,"errorTrace signal unexpected behaviour")},productSub:function(){var n=navigator.productSub;if(void 0===n)throw new c(e.Undefined,"navigator.productSub is undefined");return n},windowExternal:function(){if(void 0===window.external)throw new c(e.Undefined,"window.external is undefined");var n=window.external;if("function"!=typeof n.toString)throw new c(e.NotFunction,"window.external.toString is not a function");return n.toString()},mimeTypesConsistent:function(){if(void 0===navigator.mimeTypes)throw new c(e.Undefined,"navigator.mimeTypes is undefined");for(var n=navigator.mimeTypes,t=Object.getPrototypeOf(n)===MimeTypeArray.prototype,r=0;r<n.length;r++)t&&(t=Object.getPrototypeOf(n[r])===MimeType.prototype);return t},evalLength:function(){return eval.toString().length},webGL:function(){var n=document.createElement("canvas");if("function"!=typeof n.getContext)throw new c(e.NotFunction,"HTMLCanvasElement.getContext is not a function");var t=n.getContext("webgl");if(null===t)throw new c(e.Null,"WebGLRenderingContext is null");if("function"!=typeof t.getParameter)throw new c(e.NotFunction,"WebGLRenderingContext.getParameter is not a function");return{vendor:t.getParameter(t.VENDOR),renderer:t.getParameter(t.RENDERER)}},webDriver:function(){if(null==navigator.webdriver)throw new c(e.Undefined,"navigator.webdriver is undefined");return navigator.webdriver},languages:function(){var e,n=navigator,t=[],r=n.language||n.userLanguage||n.browserLanguage||n.systemLanguage;if(void 0!==r&&t.push([r]),Array.isArray(n.languages))p()===a.Chromium&&w([!("MediaSettingsRange"in(e=window)),"RTCEncodedAudioFrame"in e,""+e.Intl=="[object Intl]",""+e.Reflect=="[object Reflect]"])>=3||t.push(n.languages);else if("string"==typeof n.languages){var i=n.languages;i&&t.push(i.split(","))}return t},notificationPermissions:function(){return r(this,void 0,void 0,(function(){var n,t;return i(this,(function(r){switch(r.label){case 0:if(void 0===window.Notification)throw new c(e.Undefined,"window.Notification is undefined");if(void 0===navigator.permissions)throw new c(e.Undefined,"navigator.permissions is undefined");if("function"!=typeof(n=navigator.permissions).query)throw new c(e.NotFunction,"navigator.permissions.query is not a function");r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.query({name:"notifications"})];case 2:return t=r.sent(),[2,"denied"===window.Notification.permission&&"prompt"===t.state];case 3:throw r.sent(),new c(e.UnexpectedBehaviour,"notificationPermissions signal unexpected behaviour");case 4:return[2]}}))}))},documentElementKeys:function(){if(void 0===document.documentElement)throw new c(e.Undefined,"document.documentElement is undefined");var n=document.documentElement;if("function"!=typeof n.getAttributeNames)throw new c(e.NotFunction,"document.documentElement.getAttributeNames is not a function");return n.getAttributeNames()},functionBind:function(){if(void 0===Function.prototype.bind)throw new c(e.NotFunction,"Function.prototype.bind is undefined");return Function.prototype.bind.toString()},process:function(){if(void 0===window.process)throw new c(e.Undefined,"window.process is undefined");return window.process},distinctiveProps:function(){var e,t,r=((e={})[n.Awesomium]={window:["awesomium"]},e[n.Cef]={window:["RunPerfTest"]},e[n.CefSharp]={window:["CefSharp"]},e[n.CoachJS]={window:["emit"]},e[n.FMiner]={window:["fmget_targets"]},e[n.Geb]={window:["geb"]},e[n.NightmareJS]={window:["__nightmare","nightmare"]},e[n.Phantomas]={window:["__phantomas"]},e[n.PhantomJS]={window:["callPhantom","_phantom"]},e[n.Rhino]={window:["spawn"]},e[n.Selenium]={window:["_Selenium_IDE_Recorder","_selenium","calledSelenium",/^([a-z]){3}_.*_(Array|Promise|Symbol)$/],document:["__selenium_evaluate","selenium-evaluate","__selenium_unwrapped"]},e[n.WebDriverIO]={window:["wdioElectron"]},e[n.WebDriver]={window:["webdriver","__webdriverFunc","__lastWatirAlert","__lastWatirConfirm","__lastWatirPrompt","_WEBDRIVER_ELEM_CACHE","ChromeDriverw"],document:["__webdriver_script_fn","__driver_evaluate","__webdriver_evaluate","__fxdriver_evaluate","__driver_unwrapped","__webdriver_unwrapped","__fxdriver_unwrapped","__webdriver_script_fn","__webdriver_script_func","__webdriver_script_function","$cdc_asdjflasutopfhvcZLmcf","$cdc_asdjflasutopfhvcZLmcfl_","$chrome_asyncScriptInfo","__$webdriverAsyncExecutor"]},e[n.HeadlessChrome]={window:["domAutomation","domAutomationController"]},e),i={},a=l(window),u=[];for(t in void 0!==window.document&&(u=l(window.document)),r){var c=r[t];if(void 0!==c){var s=void 0!==c.window&&v.apply(void 0,o([a],c.window,!1)),d=!(void 0===c.document||!u.length)&&v.apply(void 0,o([u],c.document,!1));i[t]=s||d}}return i}},b=function(){function t(){this.components=void 0,this.detections=void 0}return t.prototype.getComponents=function(){return this.components},t.prototype.getDetections=function(){return this.detections},t.prototype.getSources=function(){return g},t.prototype.getDetectors=function(){return h},t.prototype.detect=function(){if(void 0===this.components)throw new Error("BotDetector.detect can't be called before BotDetector.collect");var e=this.components,t=this.getDetectors(),r={},i={bot:!1};for(var o in t){var a=(0,t[o])(e),u={bot:!1};"string"==typeof a?u={bot:!0,botKind:a}:a&&(u={bot:!0,botKind:n.Unknown}),r[o]=u,u.bot&&(i=u)}return this.detections=r,i},t.prototype.collect=function(){return r(this,void 0,void 0,(function(){var n,t,o,a=this;return i(this,(function(u){switch(u.label){case 0:return n=this.getSources(),t={},o=Object.keys(n),[4,Promise.all(o.map((function(o){return r(a,void 0,void 0,(function(){var r,a,u,s,d;return i(this,(function(i){switch(i.label){case 0:r=n[o],i.label=1;case 1:return i.trys.push([1,3,,4]),a=t,u=o,d={},[4,r()];case 2:return a[u]=(d.value=i.sent(),d.state=e.Success,d),[3,4];case 3:return s=i.sent(),t[o]=s instanceof c?{state:s.state,error:"".concat(s.name,": ").concat(s.message)}:{state:e.UnexpectedBehaviour,error:s instanceof Error?"".concat(s.name,": ").concat(s.message):String(s)},[3,4];case 4:return[2]}}))}))})))];case 1:return u.sent(),this.components=t,[2,this.components]}}))}))},t}();function y(e){return(void 0===e?{}:e).monitoring,r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,(e=new b).collect()];case 1:return n.sent(),[2,e]}}))}))}var S={load:y};export{n as BotKind,c as BotdError,S as default,y as load,g as sources};
